{% extends "base.html" %}

{% block title %} 
    Ship Areas & Details 
{% endblock %}

{% csrf_token %}

{% load custom_filters %}

{% block content %}
    <!-- Summaries -->
    <div class="headlines">
        <div class="summary-boxes">
            <h4 class="summary-title">Time Remaining:</h4>
            <h2 class="summary-content">{{ total_estimated_completion }} Days</h2>
        </div>

        <div class="summary-boxes">
            <h4 class="summary-title">Completion Date:</h4>
            <h2 class="summary-content">{{ today }}</h2>
        </div>
        
        <div class="summary-boxes">
            <h4 class="summary-title">Ship and Areas</h4>
            <h2 class="summary-content">{{ num_ships }}, {{ num_areas }}</h2>
        </div>
        
        <div class="summary-boxes">
            <h4 class="summary-title">Processing Time / Ship:</h4>
            <h2 class="summary-content">{{ avg_completion_time }} Weeks</h2>
        </div>
    </div>

    <!-- Ship and Area Details -->
    <div class="card-container">
        {% for ship in ships %}
            <div class="ship-card">
                 <div class="progress">
                    <div class="progress-bar" role="progressbar" style="width: {{ ship.completed_percentage }}%;" aria-valuenow="{{ ship.completed_percentage }}" aria-valuemin="0" aria-valuemax="100">{{ ship.completed_percentage }}%</div>
                </div>
                <h5 class="card-title">{{ ship.name }}</h5>
                <h5 class="card-secondary-title">Contract Number: {{ ship.contract_number }}</h5>
               
                {% if ship.image %}
                    <img src="{{ ship.image.url }}" class="ship-image" alt="...">
                {% endif %}
                {% if user.is_authenticated %}
                    <p class="card-text">Completion in {{ ship.estimated_completion }} days</p>
                {% endif %}
                <p class="card-text">Scans: {{ ship.total_scans }}</p>
                <p class="card-text">Priority: {{ ship.priority }}</p>
                <p class="card-text">Areas: {{ ship.area_set.all.count }}</p>
                <button class="more-info">
                    <a href="{% url 'ship_detail' ship.id %}">More Info</a>
                </button>
            </div>
        {% endfor %}
    </div>
{% endblock %}
